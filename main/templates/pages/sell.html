<!doctype html>
<html lang="en">
<head>
  <title>Продать</title>
  {% include "../templs/style.html" %}
</head>
<header>
  {% include "../templs/profile_btn.html" %}
</header>
<body>
  <form style="width: 100%;" method="POST" id="frm">
    {% csrf_token %}
    <div style="padding: 30px; margin: 80px 40px 0 40px; min-width: 1000px; display: flex; background-color: #312f3d; color: white; border-radius: 10px;">

      <div style="width: 25%;">
        <v-img
          src="{{ item.item.item_image }}"
          cover
          style="border-radius: 10px; width: 100%"
        ></v-img>
        <v-card-title style="margin-top: 25px; font-size: 25px; text-align: center; width: 100%">{{ item.item_name }}</v-card-title>
      </div>

      <div style="width: 75%; position: relative; margin-left: 30px">
        <p style="font-size: 20px; position: absolute; top: 0">Описание: {{ item.item.item_description }}</p>

        <v-text-field label="Введите цену" variant="outlined" name="price" id="price" type="number" min="1" max="9999999999999999999" style="position: absolute; bottom: 80px; width: 100%;" required></v-text-field>
        <v-btn id="sell_btn" color="orange" variant="tonal" style="width: 100%; height: 80px; bottom: 0; position: absolute; font-size: 25px; border: 2px solid orange" v-bind="activatorProps">
          Продать на маркете за
        </v-btn>
      </div>

    </div>
  </form>

</body>

<script src="../static/js/script.js"></script>
<script>
  'use strict';

  let inp = document.getElementById('price');
  let btn = document.getElementById('sell_btn');

  inp.addEventListener('input', function() {
    let val = document.getElementById('sell_btn');

    val.innerText = `Продать на маркете за ${inp.value}`;
  });

  btn.addEventListener('click', function() {
    Swal.fire({
      title: 'Покупка предмета',
      text: `Продать за ${inp.value}?`,
      icon: 'question',
      confirmButtonText: "Продать",
      showCancelButton: true,
      cancelButtonText: "Отмена",
      background: "#312F3D",
      color: "#FFF",
    });
    let second = document.querySelector(".swal2-confirm.swal2-styled");
    second.style.width = "130px";
    second.addEventListener('click', function() {
      let checker = Number(inp.value) >= 1;
      if (checker) {
        frm.submit();
      }
      else {
        Swal.fire({
          title: "Ошибка ввода",
          text: "Цена должна быть больше 0!",
          icon: "error",
          confirmButtonText: "Продолжить",
          background: "#312F3D",
          color: "#FFF",
        });
      }
    });
  });

</script>
</html>
